package components

import "time"

templ IndexPage(generationTimeGo time.Time) {
	<!DOCTYPE html>
	<html lang="en">
		<head>
			<meta charset="UTF-8"/>
			<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
			<title>Timer Page</title>
			<meta name="time_created" content={ generationTimeGo.Format(time.RFC3339) }/>
			<script src="https://cdn.tailwindcss.com"></script>
		</head>
		<body class="bg-gray-100 h-screen flex items-center justify-center">
			<div class="bg-white p-8 rounded-lg shadow-md text-center">
				<h1 class="text-2xl font-bold mb-4">Time Since Generation</h1>
				<p id="timer" class="text-4xl font-mono"></p>
				<p class="mt-4 text-sm text-gray-600">Page generated at: { generationTimeGo.Format("2006-01-02 15:04:05") }</p>
			</div>
			@Interval()
		</body>
	</html>
}

script Interval() {

    const text = document.querySelector('meta[name="time_created"]').content
    const generationTime = new Date(text);
				
    function updateTimer() {
        const now = new Date();
        const diff = now - generationTime;
        
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);
        
        document.getElementById('timer').textContent = 
            `${days}d ${hours}h ${minutes}m ${seconds}s`;
    }
    
    updateTimer();
    setInterval(updateTimer, 1000);

}
